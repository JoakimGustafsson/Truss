<!doctype html>
<html>

<head>
	<meta charset="UTF-8" />
	<script src="Javascript/Primitives.js" type="text/javascript"></script>
	<script src="Javascript/Property.js" type="text/javascript"></script>
	<script src="Javascript/View.js" type="text/javascript"></script>
	<script src="Javascript/Node.js" type="text/javascript"></script>
	<script src="Javascript/Tensors.js" type="text/javascript"></script>
	<script src="Javascript/Truss.js" type="text/javascript"></script>
	<script src="Javascript/Actuators.js" type="text/javascript"></script>
	<script src="Javascript/Sensors.js" type="text/javascript"></script>
	<script src="Javascript/Pictures.js" type="text/javascript"></script>
	<script src="Javascript/ExperimentalTrusses.js" type="text/javascript"></script>
	<!--	<script src="Javascript/cycle.js" type="text/javascript"></script>
	<script src="Javascript/jquery-3.1.1.js"></script>  -->

	<link rel="stylesheet" type="text/css" href="../Stylefiles/Truss.css">

	<!-- <link rel="icon" type="image/png" href="../Pictures/Atlas white logotype.png" />
<link rel="shortcut icon" href="../Pictures/Atlas white logotype.png" />  -->


	<title>Truss</title>

</head>

<body style="background-color: #343f48; margin:0px;">
	<img id="dimage" src="Resources/facade.jpg" style="position: absolute; left:0px; top:0px; width: 200px; height: 200px; " alt="Mountain View">
	
	<section>

		<div class="" id="configarea" style="position: absolute; z-index:1000; color: green; width:400px; height:200px;">
			<div class="sectionheader">Configuration</div>
			<div class="sectionbase" id="configview"></div>
		</div>

		<div id="FPSdisplay" style="position: absolute; left:10px; top:10px; color: white;">
		</div>


		<div id="TrussBackground" align="left">

		</div>


		<script type="text/javascript">
			var mainNode;
			var newMainNode;
			var savedState = 0;

			var tensors, nodes;
			var selectedObject

			//Main Draw loop
			function mainLoop(timestamp) {
				if (newMainNode) {
					mainNode.truss.clear();
					mainNode = newMainNode;

					mainNode.canvas.onmousemove = myMove;
					mainNode.canvas.onmousedown = downMouse;
					mainNode.canvas.onmouseup = upMouse;

					newMainNode = undefined;
				}
				mainNode.tick(timestamp / 1000);
				requestAnimationFrame(mainLoop);
			}

			// Setting up the canvas and ensure other initialization routines are run
			function init() {
				let WIDTH = 2000;
				let HEIGHT = 1000;
				FPSdisplay = document.getElementById("FPSdisplay");

				let mainView = new View(new Vector(WIDTH, HEIGHT), new Vector(18, 9));
				mainNode = new TrussNode(new Position(0, 0), mainView, 1 / 60, 1, "MainNode", WalkTruss);
				mainNode.truss.initiate();


				selectedObject=mainNode;

				window.requestAnimationFrame(mainLoop);



				mainView.context.canvas.onmousemove = myMove;
				mainView.context.canvas.onmousedown = downMouse;
				mainView.context.canvas.onmouseup = upMouse;
			}


			// Make sure the init is not run until all is set up. Hmmm, stop using JQuery
			//$().ready(init);


			let myX = 3;
			let myY = 3;
			let mouseSet = false;
			/**
			 * @param  {Event} e
			 */
			function myMove(e) {
				myX = e.pageX;
				myY = e.pageY;
			}

			/**
			 * @param  {Event} e
			 */
			function downMouse(e) {
				mouseSet = true;
			}

			/**
			 * @param  {Event} e
			 */
			function upMouse(e) {
				mouseSet = false;
			}

			init();

		</script>

	</section>
</body>

</html>